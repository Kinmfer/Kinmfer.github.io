<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Linux基础-09-进程+计划任务 | Kinmfer's Blogs</title><meta name="keywords" content="Linux基础,系统"><meta name="author" content="Kinmfer,kinmfer@foxmail.com"><meta name="copyright" content="Kinmfer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="进程 内核功用：进程管理、文件系统、网络功能、内存管理、驱动程序、安全功能等 Process: 运行中的程序的一个副本，是被载入内存的一个指令集合 进程ID（Process ID，PID）号码被用来标记各个进程 UID、GID、和SELinux语境决定对文件系统的存取和访问权限 通常从执行进程的用户来继承 存在生命周期   task struct：Linux内核存储进程信息的数据结构格式 task">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux基础-09-进程+计划任务">
<meta property="og:url" content="https://kinmfer.github.io/2020/05/03/Linux%E5%9F%BA%E7%A1%80-09-%E8%BF%9B%E7%A8%8B+%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/index.html">
<meta property="og:site_name" content="Kinmfer&#39;s Blogs">
<meta property="og:description" content="进程 内核功用：进程管理、文件系统、网络功能、内存管理、驱动程序、安全功能等 Process: 运行中的程序的一个副本，是被载入内存的一个指令集合 进程ID（Process ID，PID）号码被用来标记各个进程 UID、GID、和SELinux语境决定对文件系统的存取和访问权限 通常从执行进程的用户来继承 存在生命周期   task struct：Linux内核存储进程信息的数据结构格式 task">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg">
<meta property="article:published_time" content="2020-05-03T13:13:15.000Z">
<meta property="article:modified_time" content="2021-03-06T07:36:54.001Z">
<meta property="article:author" content="Kinmfer">
<meta property="article:tag" content="Linux基础">
<meta property="article:tag" content="系统">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://kinmfer.github.io/2020/05/03/Linux%E5%9F%BA%E7%A1%80-09-%E8%BF%9B%E7%A8%8B+%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c46ed77365f502de73543fbf10399875";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"C2N62A47W9","apiKey":"0c62f17095ec2a20c19657511a42c0b1","indexName":"Blogs","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"这篇文章更新于","messageNext":"天前,内容可能已经过时"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":200,"languages":{"author":"作者: Kinmfer","link":"链接: ","source":"来源: Kinmfer's Blogs","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-center"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-06 15:36:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">105</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">63</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Kinmfer's Blogs</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux基础-09-进程+计划任务</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-05-03T13:13:15.000Z" title="发表于 2020-05-03 21:13:15">2020-05-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-06T07:36:54.001Z" title="更新于 2021-03-06 15:36:54">2021-03-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>32分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux基础-09-进程+计划任务"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/05/03/Linux%E5%9F%BA%E7%A1%80-09-%E8%BF%9B%E7%A8%8B+%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2020/05/03/Linux%E5%9F%BA%E7%A1%80-09-%E8%BF%9B%E7%A8%8B+%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h1><ul>
<li>内核功用：进程管理、文件系统、网络功能、内存管理、驱动程序、安全功能等</li>
<li>Process: 运行中的程序的一个副本，是被载入内存的一个指令集合<ul>
<li>进程ID（Process ID，PID）号码被用来标记各个进程</li>
<li>UID、GID、和SELinux语境决定对文件系统的存取和访问权限</li>
<li>通常从执行进程的用户来继承</li>
<li>存在生命周期</li>
</ul>
</li>
<li>task struct：Linux内核存储进程信息的数据结构格式</li>
<li>task list：多个任务的的task struct组成的链表</li>
<li>进程创建：<ul>
<li>init：第一个进程</li>
<li>进程：除了init进程，其他进程都由其父进程创建，fork()自身而来，父子关系</li>
<li>CoW，写时复制，即如果子进程需要修改数据，会把父进程的数据复制一份出来再修改</li>
</ul>
</li>
</ul>
<h2 id="进程，线程和协程"><a href="#进程，线程和协程" class="headerlink" title="进程，线程和协程"></a>进程，线程和协程</h2><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200503213959495.png" alt="image-20200503213959495" style="zoom:80%;" />

<p>1、进程</p>
<p>进程是具有一定独立功能的程序关于某个数据集合上的一次运行活动,进程是系统进行资源分配和调度的一个独立单位。每个进程都有自己的独立内存空间，不同进程通过进程间通信来通信。由于进程比较重量，占据独立的内存，所以上下文进程间的切换开销（栈、寄存器、虚拟内存、文件句柄等）比较大，但相对比较稳定安全。</p>
<p>2、线程</p>
<p>线程是进程的一个实体,是CPU调度和分派的基本单位,它是比进程更小的能独立运行的基本单位.线程自己基本上不拥有系统资源,只拥有一点在运行中必不可少的资源(如程序计数器,一组寄存器和栈),但是它可与同属一个进程的其他的线程共享进程所拥有的全部资源。线程间通信主要通过共享内存，上下文切换很快，资源开销较少，但相比进程不够稳定容易丢失数据。</p>
<p>3、协程</p>
<p><strong>协程是一种用户态的轻量级线程，</strong>协程的调度完全由用户控制。协程拥有自己的寄存器上下文和栈。协程调度切换时，将寄存器上下文和栈保存到其他地方，在切回来的时候，恢复先前保存的寄存器上下文和栈，直接操作栈则基本没有内核切换的开销，可以不加锁的访问全局变量，所以上下文的切换非常快。</p>
<hr>
<p>1、进程与线程比较</p>
<p>线程是指进程内的一个执行单元,也是进程内的可调度实体。线程与进程的区别:</p>
<ol>
<li>地址空间:线程是进程内的一个执行单元，进程内至少有一个线程，它们共享进程的地址空间，而进程有自己独立的地址空间</li>
<li>资源拥有:进程是资源分配和拥有的单位,同一个进程内的线程共享进程的资源</li>
<li>线程是处理器调度的基本单位,但进程不是</li>
<li>二者均可并发执行</li>
<li>每个独立的线程有一个程序运行的入口、顺序执行序列和程序的出口，但是线程不能够独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制</li>
</ol>
<p>2、协程多与线程进行比较</p>
<ol>
<li><p>一个线程可以多个协程，一个进程也可以单独拥有多个协程，这样python中则能使用多核CPU。</p>
</li>
<li><p>线程进程都是同步机制，而协程则是异步</p>
</li>
<li><p>协程能保留上一次调用时的状态，每次过程重入时，就相当于进入上一次调用的状态</p>
</li>
</ol>
<h2 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h2><ul>
<li>Page Frame: 页框，用存储页面数据，存储Page 4k</li>
<li>物理地址空间和线性地址空间</li>
<li>MMU：Memory Management Unit 负责转换线性和物理地址</li>
<li>TLB：Translation Lookaside Buffer 翻译后备缓冲器<br>用于保存虚拟地址和物理地址映射关系的缓存</li>
<li>LRU：Least Recently Used 近期最少使用算法,释放内存</li>
</ul>
<h2 id="用户和内核空间"><a href="#用户和内核空间" class="headerlink" title="用户和内核空间"></a>用户和内核空间</h2><p><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200503214119610.png" alt="image-20200503214119610"></p>
<h2 id="进程的基本状态及转换"><a href="#进程的基本状态及转换" class="headerlink" title="进程的基本状态及转换"></a>进程的基本状态及转换</h2><ul>
<li>创建状态：进程在创建时需要申请一个空白PCB(process control block进程控制块)，向其中填写控制和管理进程的信息，完成资源分配。如果创建工作无法完成，比如资源无法满足，就无法被调度运行，把此时进程所处状态称为创建状态</li>
<li>就绪状态：进程已准备好，已分配到所需资源，只要分配到CPU就能够立即运行</li>
<li>执行状态：进程处于就绪状态被调度后，进程进入执行状态</li>
<li>阻塞状态：正在执行的进程由于某些事件（I/O请求，申请缓存区失败）而暂时无法运行，进程受到阻塞。在满足请求时进入就绪状态等待系统调用</li>
<li>终止状态：进程结束，或出现错误，或被系统终止，进入终止状态。无法再执行</li>
</ul>
<hr>
<p><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200503214227297.png" alt="image-20200503214227297"></p>
<p>转换的六种情况</p>
<ul>
<li>运行——&gt;就绪：1，主要是进程占用CPU的时间过长，而系统分配给该进程占用CPU的时间是有限的；2，在采用抢先式优先级调度算法的系统中,当有更高优先级的进程要运行时，该进程就被迫让出CPU，该进程便由执行状态转变为就绪状态</li>
<li>就绪——&gt;运行：运行的进程的时间片用完，调度就转到就绪队列中选择合适的进程分配CPU</li>
<li>运行——&gt;阻塞：正在执行的进程因发生某等待事件而无法执行，则进程由执行状态变为阻塞状态，如发生了I/O请求</li>
<li>阻塞——&gt;就绪:进程所等待的事件已经发生，就进入就绪队列</li>
<li>以下两种状态是不可能发生的：<ul>
<li>阻塞——&gt;运行：即使给阻塞进程分配CPU，也无法执行，操作系统在进行调度时不会从阻塞队列进行挑选，而是从就绪队列中选取</li>
<li>就绪——&gt;阻塞：就绪态根本就没有执行，谈不上进入阻塞态</li>
</ul>
</li>
</ul>
<h2 id="LRU算法"><a href="#LRU算法" class="headerlink" title="LRU算法"></a>LRU算法</h2><p>假设序列为 4 3 4 2 3 1 4 2物理块有3个，则</p>
<ul>
<li>第1轮 4调入内存 4</li>
<li>第2轮 3调入内存 3 4</li>
<li>第3轮 4调入内存 4 3</li>
<li>第4轮 2调入内存 2 4 3</li>
<li>第5轮 3调入内存 3 2 4</li>
<li>第6轮 1调入内存 1 3 2</li>
<li>第7轮 4调入内存 4 1 3</li>
<li>第8轮 2调入内存 2 4 1</li>
</ul>
<p><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200503214454170.png" alt="image-20200503214454170"></p>
<h2 id="IPC进程间通信"><a href="#IPC进程间通信" class="headerlink" title="IPC进程间通信"></a>IPC进程间通信</h2><p>IPC: Inter Process Communication</p>
<ul>
<li>同一主机：<ul>
<li>pipe 管道<ul>
<li>它是半双工的（即数据只能在一个方向上流动），具有固定的读端和写端。</li>
<li>它只能用于具有亲缘关系的进程之间的通信（也是父子进程或者兄弟进程之间）。</li>
<li>它可以看成是一种特殊的文件，对于它的读写也可以使用普通的read、write 等函数。但是它不是普通的文件，并不属于其他任何文件系统，并且只存在于内存中。</li>
</ul>
</li>
<li>FIFO 命名管道<ul>
<li>FIFO可以在无关的进程之间交换数据，与无名管道不同。</li>
<li>FIFO有路径名与之相关联，它以一种特殊设备文件形式存在于文件系统中。</li>
</ul>
</li>
<li>MessageQueue 消息队列<ul>
<li>消息队列是面向记录的，其中的消息具有特定的格式以及特定的优先级。</li>
<li>消息队列独立于发送与接收进程。进程终止时，消息队列及其内容并不会被删除。</li>
<li>消息队列可以实现消息的随机查询,消息不一定要以先进先出的次序读取,也可以按消息的类型读取。</li>
</ul>
</li>
<li>shm ：shared memory 指两个或多个进程共享一个给定的存储区。<ul>
<li>共享内存是最快的一种 IPC，因为进程是直接对内存进行存取。</li>
<li>因为多个进程可以同时操作，所以需要进行同步。</li>
<li>信号量+共享内存通常结合在一起使用，信号量用来同步对共享内存的访问。</li>
</ul>
</li>
<li>semaphore 是一个计数器。信号量用于实现进程间的互斥与同步，而不是用于存储进程间通信数据。<ul>
<li>信号量用于进程间同步，若要在进程间传递数据需要结合共享内存。</li>
<li>信号量基于操作系统的 PV 操作，程序对信号量的操作都是原子操作。</li>
<li>每次对信号量的 PV 操作不仅限于对信号量值加 1 或减 1，而且可以加减任意正整数。</li>
<li>支持信号量组。</li>
</ul>
</li>
<li>5种通信方式总结<ul>
<li>1.管道：速度慢，容量有限，只有父子进程能通讯   </li>
<li>2.FIFO：任何进程间都能通讯，但速度慢   </li>
<li>3.消息队列：容量受到系统限制，且要注意第一次读的时候，要考虑上一次没有读完数据的问题   </li>
<li>4.信号量：不能传递复杂消息，只能用来同步   </li>
<li>5.共享内存区：能够很容易控制容量，速度快，但要保持同步，比如一个进程在写的时候，另一个进程要注意读写的问题，相当于线程中的线程安全，当然，共享内存区同样可以用作线程间通讯，不过没这个必要，线程间本来就已经共享了同一进程内的一块内存</li>
</ul>
</li>
</ul>
</li>
<li>不同主机：socket IP和端口号<ul>
<li>RPC ：Remote Procedure Call</li>
<li>MQ 消息队列，如：Kafka，RabbitMQ，ActiveMQ</li>
</ul>
</li>
</ul>
<h2 id="进程优先级"><a href="#进程优先级" class="headerlink" title="进程优先级"></a>进程优先级</h2><p><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200503214617437.png" alt="image-20200503214617437"></p>
<p><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200503214625339.png" alt="image-20200503214625339"></p>
<ul>
<li><p>进程优先级：</p>
<ul>
<li><p>系统优先级：数字越小，优先级越高</p>
<ul>
<li>0-139：各有140个运行队列和过期队列</li>
</ul>
</li>
<li><p>实时优先级: 99-0 值最大优先级最高</p>
</li>
<li><p>nice值：-20到19，对应系统优先级100-139</p>
<p>注意：仅管理员可调低nice值</p>
<ul>
<li><p>nice命令<br>nice [OPTION] [COMMAND [ARG]…]</p>
<p><code>nice -n 19 vim &amp;  </code>#设置优先级为19</p>
</li>
<li><p>renice命令<br>renice [-n] priority pid…</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Big O：时间复杂度，用时和规模的关系</p>
<ul>
<li>O(1), O(logn), O(n)线性, O(n^2)抛物线, O(2^n)</li>
</ul>
</li>
</ul>
<h2 id="进程运行状态"><a href="#进程运行状态" class="headerlink" title="进程运行状态"></a>进程运行状态</h2><ul>
<li><p>Linux内核：抢占式多任务</p>
</li>
<li><p>进程类型：</p>
<ul>
<li>守护进程: daemon,在系统引导过程中启动的进程，和终端无关进程</li>
<li>前台进程(用户进程)：跟终端相关，通过终端启动的进程</li>
<li>注意：两者可相互转化</li>
</ul>
</li>
<li><p>进程状态：</p>
<ul>
<li><p>运行态：running</p>
</li>
<li><p>就绪态：ready</p>
<blockquote>
<p><strong>就绪状态的状态标志state的值为TASK_RUNNING。</strong>此时，程序已被挂入运行队列，处于准备运行状态。一旦获得处理器使用权，即可进入运行状态。</p>
<p><strong>当进程获得处理器而运行时 ，state的值仍然为TASK_RUNNING</strong>，并不发生改变；但Linux会把一个专门用来指向当前运行任务的指针current指向它，以表示它是一个正在运行的进程。</p>
</blockquote>
</li>
<li><p>睡眠态：</p>
<ul>
<li>可中断：interruptable <strong>状态标志state的值为TASK_INTERRUPTIBL</strong>。此时，由于进程未获得它所申请的资源而处在等待状态。一旦资源有效或者有唤醒信号，进程会立即结束等待而进入就绪状态。</li>
<li>不可中断：uninterruptable <strong>状态标志state的值为TASK_UNINTERRUPTIBL</strong>。此时，进程也处于等待资源状态。一旦资源有效，进程会立即进入就绪状态。这个等待状态与可中断等待状态的区别在于：处于TASK_UNINTERRUPTIBL状态的进程不能被信号量或者中断所唤醒，只有当它申请的资源有效时才能被唤醒。这个状态被应用在内核中某些场景中，比如当进程需要对磁盘进行读写，而此刻正在DMA中进行着数据到内存的拷贝，如果这时进程休眠被打断（比如强制退出信号）那么很可能会出现问题，所以这时进程就会处于不可被打断的状态下。</li>
</ul>
</li>
<li><p>停止态：<strong>状态标志state的值为TASK_STOPPED。</strong>当进程收到一个SIGSTOP信号后，就由运行状态进入停止状态，当受到一个SIGCONT信号时，又会恢复运行状态。这种状态主要用于程序的调试，又被叫做“暂停状态”、“挂起状态”，即暂停于内存，但不会被调度，除非手动启动</p>
</li>
<li><p>僵死态：<strong>状态标志state的值为TASK_DEAD。</strong>进程因某种原因而中止运行，进程占有的所有资源将被回收，除了task_struct结构（以及少数资源）以外，并且系统对它不再予以理睬，所以这种状态也叫做“僵死状态”，父进程结束前，子进程不关闭</p>
</li>
</ul>
</li>
</ul>
<h2 id="进程的分类"><a href="#进程的分类" class="headerlink" title="进程的分类"></a>进程的分类</h2><ul>
<li>CPU-Bound：CPU密集型，非交互</li>
<li>IO-Bound：IO密集型，交互</li>
</ul>
<h1 id="管理工具"><a href="#管理工具" class="headerlink" title="管理工具"></a>管理工具</h1><h2 id="进程-1"><a href="#进程-1" class="headerlink" title="进程"></a>进程</h2><ul>
<li><p>Linux系统状态的查看及管理工具：</p>
<p>pstree, ps, pidof, pgrep, top, htop, glance, pmap, vmstat, dstat, kill, pkill, job, bg, fg, nohup</p>
</li>
<li><p>/proc/uptime 包括两个值，单位 s<br>系统启动时长，空闲进程的总时长（按总的CPU核数计算）</p>
</li>
<li><p>uptime 和 w</p>
<p>显示当前时间，系统已启动的时间、当前上线人数，系统平均负载（1、5、15)分钟的平均负载，一般不会超过1，超过5时建议警报）</p>
<ul>
<li>系统平均负载:<ul>
<li>指在特定时间间隔内运行队列中的平均进程数</li>
</ul>
</li>
<li>通常每个CPU内核的当前活动进程数不大于3，那么系统的性能良好。如果每个CPU内核的任务数大于5，那么此主机的性能有严重问题</li>
<li>如果linux主机是1个双核CPU，当Load Average 为6的时候说明机器已经被充分使用</li>
</ul>
</li>
</ul>
<h3 id="pstree"><a href="#pstree" class="headerlink" title="pstree"></a>pstree</h3><p>进程树查看</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@host1 ~]<span class="comment"># pstree</span></span><br><span class="line">systemd─┬─NetworkManager───2*[&#123;NetworkManager&#125;]</span><br><span class="line">        ├─VGAuthService</span><br><span class="line">        ├─agetty</span><br><span class="line">        ├─atd</span><br><span class="line">        ├─auditd───&#123;auditd&#125;</span><br><span class="line">        ├─chronyd</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon</span><br><span class="line">        ├─irqbalance───&#123;irqbalance&#125;</span><br><span class="line">        ├─polkitd───5*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rngd───&#123;rngd&#125;</span><br><span class="line">        ├─rsyslogd───2*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─sshd───sshd───sshd───bash───pstree</span><br><span class="line">        ├─sssd─┬─sssd_be</span><br><span class="line">        │      └─sssd_nss</span><br><span class="line">        ├─systemd───(sd-pam)</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-resolve</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        ├─tuned───3*[&#123;tuned&#125;]</span><br><span class="line">        └─vmtoolsd───&#123;vmtoolsd&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h3><ul>
<li>ps [OPTION]…  显示命令执行那一刻的进程状态</li>
<li>支持三种选项：<ul>
<li>UNIX选项  如-A -e</li>
<li>BSD选项 如a</li>
<li>GNU选项 如–help</li>
<li>选项：默认显示当前终端中的进程<ul>
<li>a 选项包括所有与终端相关的进程</li>
<li>x 选项包括所有与终端无关的进程</li>
<li>u 选项显示进程所有者的信息</li>
<li>f 选项显示进程树</li>
<li>k|–sort  属性 对属性排序,属性前加- 表示倒序</li>
<li>o 属性… 选项显示定制的信息 pid、cmd、%cpu、%mem。以逗号分隔</li>
<li>L 显示支持的属性列表</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="ps常见选项"><a href="#ps常见选项" class="headerlink" title="ps常见选项"></a>ps常见选项</h4><ul>
<li><p>-C cmdlist 指定命令，多个命令用，分隔</p>
</li>
<li><p>-L 显示线程</p>
</li>
<li><p>-e 显示所有进程，相当于-A</p>
</li>
<li><p>-f 显示完整格式程序信息</p>
</li>
<li><p>-F 显示更完整格式的进程信息</p>
</li>
<li><p>-H 以进程层级格式显示进程相关信息</p>
</li>
<li><p>-u userlist  指定有效用户ID或名称</p>
</li>
<li><p>-U userlist 指定实际用户ID或名称</p>
<blockquote>
<p>实际用户：表示一开始执行程序的用户，比如用账号iceup登录shell，然后执行程序ls，那么实际用户就是iceup。<br>有效用户：有效用户是指在程序运行时，计算权限的用户。大多数情况下实际用户和有效用户相等，但是在执行拥有SUID权限的程序的时候，这两个用户通常会不一致。</p>
</blockquote>
</li>
<li><p>-g gid或groupname  指定有效gid或组名称</p>
</li>
<li><p>-G gid或groupname  指定实际gid或组名称</p>
</li>
<li><p>-p pid 显示pid的进程</p>
</li>
<li><p>–ppid pid  显示属于pid的子进程</p>
</li>
<li><p>-t ttylist 指定tty,相当于 t</p>
</li>
<li><p>-M 显示SELinux信息，相当于Z</p>
</li>
</ul>
<h4 id="ps输出属性"><a href="#ps输出属性" class="headerlink" title="ps输出属性"></a>ps输出属性</h4><ul>
<li>VSZ: Virtual memory SiZe，虚拟内存集，线性内存</li>
<li>RSS: ReSident Size, 常驻内存集</li>
<li>TTY: 终端</li>
<li>STAT：进程状态<ul>
<li>R：running </li>
<li>S: interruptable sleeping</li>
<li>D: uninterruptable sleeping</li>
<li>T: stopped</li>
<li>Z: zombie</li>
<li>+: 前台进程</li>
<li>l: 多线程进程</li>
<li>L：内存分页并带锁</li>
<li>N：低优先级进程</li>
<li>&lt;: 高优先级进程</li>
<li>s: session leader，会话（子进程）发起者</li>
</ul>
</li>
<li>ni: nice值</li>
<li>pri: priority 优先级</li>
<li>rtprio: 实时优先级</li>
<li>C：cpu utilization  占用百分比</li>
<li>psr: processor CPU编号</li>
<li>SHR：共享内存大小，单位kb</li>
<li>示例：<ul>
<li>ps axo pid,cmd,psr,ni,pri,rtprio</li>
</ul>
</li>
<li>常用组合：<ul>
<li>aux</li>
<li>-ef</li>
<li>-eFH</li>
<li>-eo pid,tid,class,rtprio,ni,pri,psr,pcpu,stat,comm</li>
<li>axo stat,euid,ruid,tty,tpgid,sess,pgrp,ppid,pid,pcpu,comm</li>
</ul>
</li>
</ul>
<h4 id="ps示例"><a href="#ps示例" class="headerlink" title="ps示例"></a>ps示例</h4><ul>
<li><p>查询你拥有的所有进程</p>
<ul>
<li><code>ps -x</code></li>
</ul>
</li>
<li><p>显示指定用户名(RUID)或用户ID的进程</p>
<ul>
<li><code>ps -fU apache</code></li>
<li><code>ps -fU 48</code></li>
</ul>
</li>
<li><p>显示指定用户名(EUID)或用户ID的进程</p>
<ul>
<li><code>ps -fu wang</code></li>
<li><code>ps -fu 1000</code></li>
</ul>
</li>
<li><p>查看以root用户权限（实际和有效ID）运行的每个进程</p>
<ul>
<li><code>ps -U root -u root</code></li>
</ul>
</li>
<li><p>列出某个组拥有的所有进程（实际组ID：RGID或名称）</p>
<ul>
<li><code>ps -fG nginx</code></li>
</ul>
</li>
<li><p>列出有效组名称（或会话）所拥有的所有进程</p>
<ul>
<li><code>ps -fg mysql</code></li>
<li><code>ps -fg 27</code></li>
</ul>
</li>
<li><p>显示指定的进程ID对应的进程</p>
<ul>
<li><code>ps -fp 1234</code></li>
</ul>
</li>
<li><p>以父进程ID来显示其下所有的进程，如显示父进程为1234的所有进程</p>
<ul>
<li><code>ps -f --ppid 1234</code></li>
</ul>
</li>
<li><p>显示指定PID的多个进程</p>
<ul>
<li><code>ps -fp 1204,1239,1263</code></li>
</ul>
</li>
<li><p>要按tty显示所属进程</p>
<ul>
<li><code>ps -ft pts/0</code></li>
</ul>
</li>
<li><p>以进程树显示系统中的进程如何相互链接</p>
<ul>
<li><code>ps -e --forest</code></li>
</ul>
</li>
<li><p>以进程树显示指定的进程</p>
<ul>
<li><code>ps -f --forest -C sshd</code></li>
<li><code>ps -ef --forest | grep -v grep | grep sshd</code></li>
</ul>
</li>
<li><p>要显示一个进程的所有线程,将显示LWP（轻量级进程）以及NLWP（轻量级进程数）列</p>
<ul>
<li><code>ps -fL -C nginx</code></li>
</ul>
</li>
<li><p>要列出所有格式说明符</p>
<ul>
<li><code>ps L</code></li>
</ul>
</li>
<li><p>查看进程的PID，PPID，用户名和命令</p>
<ul>
<li><code>ps -eo pid,ppid,user,cmd</code></li>
</ul>
</li>
<li><p>自定义格式显示文件系统组,ni值开始时间和进程的时间</p>
<ul>
<li><code>ps -p 1234 -o pid,ppid,fgroup,ni,lstart,etime</code></li>
</ul>
</li>
<li><p>使用其PID查找进程名称：</p>
<ul>
<li><code>ps -p 1244 -o comm=x</code></li>
</ul>
</li>
<li><p>要以其名称选择特定进程，显示其所有子进程</p>
<ul>
<li><code>ps -C sshd,bash</code></li>
</ul>
</li>
<li><p>查找指定进程名所有的所属PID，在编写需要从std输出或文件读取PID的脚本时这个参数很有用</p>
<ul>
<li><code>ps -C httpd,sshd -o pid=x</code></li>
</ul>
</li>
<li><p>检查一个进程的执行时间</p>
<ul>
<li><code>ps -eo comm,etime,user | grep nginx</code></li>
</ul>
</li>
<li><p>查找占用最多内存和CPU的进程</p>
<ul>
<li><code>ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%mem | head</code></li>
<li><code>ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%cpu | head</code></li>
</ul>
</li>
<li><p>显示安全信息</p>
<ul>
<li><code>ps -eM</code>                    </li>
<li><code>ps --context</code></li>
</ul>
</li>
<li><p>使用以下命令以用户定义的格式显示安全信息</p>
<ul>
<li><code>ps -eo euser,ruser,suser,fuser,f,comm,label</code></li>
</ul>
</li>
<li><p>使用watch实用程序执行重复的输出以实现对就程进行实时的监视，如下面的命令显示每秒钟的监视</p>
<ul>
<li><code>watch -n 1 &#39;ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%mem | head&#39;</code></li>
</ul>
</li>
</ul>
<h3 id="pgrep"><a href="#pgrep" class="headerlink" title="pgrep"></a>pgrep</h3><ul>
<li>-u uid  有效用户</li>
<li>-U uid  真实用户</li>
<li>-t TERMINAL  与指定的终端相关的进程</li>
<li>-l  显示进程名</li>
<li>-a  显示完整格式的进程名</li>
<li>-P pid：显示此进程的子进程</li>
</ul>
<h3 id="pidof"><a href="#pidof" class="headerlink" title="pidof"></a>pidof</h3><p>根据进程名，取其pid</p>
<p><code>pidof sshd</code></p>
<h3 id="top"><a href="#top" class="headerlink" title="top"></a>top</h3><ul>
<li><p>top：有许多内置命令</p>
<ul>
<li>排序：<ul>
<li>P：以占据的CPU百分比,%CPU</li>
<li>M：占据内存百分比,%MEM</li>
<li>T：累积占据CPU时长,TIME+</li>
</ul>
</li>
<li>首部信息显示：<ul>
<li>uptime信息：l命令</li>
<li>tasks及cpu信息：t命令</li>
<li>cpu分别显示：1 (数字)</li>
<li>memory信息：m命令</li>
</ul>
</li>
<li>退出命令：q</li>
<li>修改刷新时间间隔：s</li>
<li>终止指定进程：k</li>
<li>保存文件：W</li>
</ul>
</li>
<li><p>指定显示的任务数：n</p>
</li>
<li><p>栏位信息简介</p>
<ul>
<li>us：用户空间</li>
<li>sy：内核空间</li>
<li>ni：调整nice时间</li>
<li>id：空闲</li>
<li>wa：等待IO时间</li>
<li>hi：硬中断</li>
<li>si：软中断s</li>
<li>st：虚拟机偷走的时间</li>
</ul>
</li>
<li><p>选项：</p>
<ul>
<li>-d # 指定刷新时间间隔，默认为3秒</li>
<li>-b 以批次方式显示</li>
<li>-n # 刷新多少次后退出</li>
<li>-H 线程模式，示例：top -H -p `pidof mysqld`</li>
</ul>
</li>
</ul>
<h3 id="htop"><a href="#htop" class="headerlink" title="htop"></a>htop</h3><ul>
<li><p>选项：</p>
<ul>
<li>-d #: 指定延迟时间；</li>
<li>-u UserName: 仅显示指定用户的进程</li>
<li>-s COLUME: 以指定字段进行排序</li>
</ul>
</li>
<li><p>子命令：</p>
<ul>
<li>s：跟踪选定进程的系统调用</li>
<li>l：显示选定进程打开的文件列表</li>
<li>a：将选定的进程绑定至某指定CPU核心</li>
<li>t：显示进程树</li>
</ul>
</li>
</ul>
<h3 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h3><ul>
<li>kill命令：向进程发送控制信号，以实现对进程管理,每个信号对应一个数字，信号名称以SIG开头（可省略），不区分大小写<ul>
<li>显示当前系统可用信号： <code>kill –l</code> 或者 <code>trap -l</code></li>
<li>常用信号：<code>man 7 signal</code><ol>
<li>SIGHUP 无须关闭进程而让其重读配置文件</li>
<li>SIGINT 中止正在运行的进程；相当于Ctrl+c</li>
<li>SIGQUIT 相当于ctrl+\</li>
<li>SIGKILL 强制杀死正在运行的进程</li>
<li>SIGTERM 终止正在运行的进程</li>
<li>SIGCONT 继续运行</li>
<li>SIGSTOP 后台休眠</li>
</ol>
</li>
<li>指定信号的方法 :<ul>
<li>(1) 信号的数字标识：1, 2, 9</li>
<li>(2) 信号完整名称：SIGHUP</li>
<li>(3) 信号的简写名称：HUP</li>
</ul>
</li>
</ul>
</li>
<li>按PID：kill [-SIGNAL] pid …<ul>
<li><code>kill –n SIGNAL pid</code></li>
<li><code>kill –s SIGNAL pid</code></li>
</ul>
</li>
<li>按名称：<code>killall [-SIGNAL] comm…</code></li>
<li>按模式：<code>pkill [options] pattern</code><ul>
<li>-SIGNAL</li>
<li>-u uid: effective user，生效者</li>
<li>-U uid: real user，真正发起运行命令者</li>
<li>-v: 与条件不符合的程序</li>
</ul>
</li>
</ul>
<h2 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h2><h3 id="free"><a href="#free" class="headerlink" title="free"></a>free</h3><p>free [OPTION]</p>
<ul>
<li><p>-b 以字节为单位</p>
</li>
<li><p>-m 以MB为单位</p>
</li>
<li><p>-g 以GB为单位</p>
</li>
<li><p>-h 易读格式</p>
</li>
<li><p>-t  显示RAM + swap的总和<br>-s n 刷新间隔为n秒<br>-c n 刷新n次后即退出</p>
<p><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200503221502623.png" alt="image-20200503221502623"></p>
</li>
</ul>
<h4 id="cache和buffer的区别"><a href="#cache和buffer的区别" class="headerlink" title="cache和buffer的区别"></a>cache和buffer的区别</h4><ol>
<li><p>Cache：缓存区，是高速缓存，是位于CPU和主存之间的量较小但速度很快的存储器，因为内CPU的速度远远高于主内容存的速度，CPU从内存中读取数据需等待很长的时间，而 Cache保存着CPU刚用过的数据或循环使用的部分数据，这时从Cache中读取数据会更快，减少了CPU等待的时间，提高了系统的性能。</p>
<p>Cache并不是缓存文件的，而是缓存块的(块是I/O读写最小的单元)；Cache一般会用在I/O请求上，如果多个进程要访问某个文件，可以把此文件读入Cache中，这样下一个进程获取CPU控制权并访问此文件直接从Cache读取，提高系统性能。</p>
</li>
<li><p>Buffer：缓冲区，用于存储速度不同步的设备或优先级不同的设备之间传输数据；通过buffer可以减少进程间通信需要等待的时间，当存储速度快的设备与存储速度慢的设备进行通信时，存储慢的数据先把数据存放到buffer，达到一定程度存储快的设备再读取buffer的数据，在此期间存储快的设备CPU可以干其他的事情。</p>
</li>
</ol>
<p>Buffer：一般是用在写入磁盘的，例如：某个进程要求多个字段被读入，当所有要求的字段被读入之前已经读入的字段会先放到buffer中。</p>
<h3 id="vmstat"><a href="#vmstat" class="headerlink" title="vmstat"></a>vmstat</h3><ul>
<li>vmstat命令：虚拟内存信息<ul>
<li>vmstat [options] [delay] [count]</li>
<li>vmstat 2 5 </li>
</ul>
</li>
<li>选项：<br>-s: 显示内存的统计数据</li>
</ul>
<hr>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@backup backup]<span class="comment"># vmstat</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy id wa st</span><br><span class="line"> 1  0      0 387012   3268 248620    0    0     5     1   43   60  0  0 100  0  0</span><br></pre></td></tr></table></figure>
<p>输出格式说明：</p>
<ul>
<li>procs:<ul>
<li>r：可运行（正运行或等待运行）进程的个数，和核心数有关</li>
<li>b：处于不可中断睡眠态的进程个数(被阻塞的队列的长度)</li>
</ul>
</li>
<li>memory：<ul>
<li>swpd: 交换内存的使用总量</li>
<li>free：空闲物理内存总量</li>
<li>buffer：用于buffer的内存总量</li>
<li>cache：用于cache的内存总量</li>
</ul>
</li>
<li>swap:<ul>
<li>si：从磁盘交换进内存的数据速率(kb/s)</li>
<li>so：从内存交换至磁盘的数据速率(kb/s)</li>
</ul>
</li>
<li>io：<ul>
<li>bi：从块设备读入数据到系统的速率(kb/s)</li>
<li>bo: 保存数据至块设备的速率</li>
</ul>
</li>
<li>system：<ul>
<li>in: interrupts 中断速率，包括时钟</li>
<li>cs: context switch 进程(上下文)切换速率</li>
</ul>
</li>
<li>cpu：<ul>
<li>us:Time spent running non-kernel code</li>
<li>sy: Time spent running kernel code</li>
<li>id: Time spent idle. Linux 2.5.41前,包括IO-wait time.</li>
<li>wa: Time spent waiting for IO. 2.5.41前，包括in idle.</li>
<li>st: Time stolen from a virtual machine. 2.6.11前, unknown.</li>
</ul>
</li>
</ul>
<h3 id="pmap"><a href="#pmap" class="headerlink" title="pmap"></a>pmap</h3><p>report memory map of a peocess</p>
<p>pmap [options] pid […]</p>
<ul>
<li>-x  查看细节</li>
<li>-X  查看更多细节</li>
</ul>
<p>另一种查看方式</p>
<p><code>cat /proc/PID/maps</code></p>
<h2 id="作业管理"><a href="#作业管理" class="headerlink" title="作业管理"></a>作业管理</h2><ul>
<li><p>Linux的作业控制</p>
<ul>
<li>前台作业：通过终端启动，且启动后一直占据终端</li>
<li>后台作业：可通过终端启动，但启动后即转入后台运行（释放终端）</li>
</ul>
</li>
<li><p>让作业运行于后台<br>(1) 运行中的作业： Ctrl+z<br>(2) 尚未启动的作业：COMMAND &amp;</p>
<p>后台作业虽然被送往后台运行，但其依然与终端相关；退出终端，将关闭后台作业。如果希望送往后台后剥离与终端的关系</p>
<ul>
<li>nohup COMMAND &amp;&gt;/dev/null &amp;   </li>
<li>screen；COMMAND</li>
</ul>
</li>
<li><p>查看当前终端所有作业：<code>jobs</code></p>
</li>
<li><p>作业控制：</p>
<ul>
<li>fg [[%]JOB_NUM]：把指定的后台作业调回前台</li>
<li>bg [[%]JOB_NUM]：让送往后台的作业在后台继续运行</li>
<li>kill [%JOB_NUM]： <strong>终止指定的作业  %不能省</strong></li>
</ul>
</li>
<li><p>并行运行同时运行多个进程，提高效率</p>
<ul>
<li><p>方法1</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim all.sh</span><br><span class="line">f1.sh&amp;</span><br><span class="line">f2.sh&amp;</span><br><span class="line">f3.sh&amp;</span><br></pre></td></tr></table></figure></li>
<li><p>方法2</p>
<p>(f1.sh&amp;);(f2.sh&amp;);(f3.sh&amp;)</p>
</li>
<li><p>方法3</p>
<p>{ f1.sh&amp; f2.sh&amp; f3.sh&amp; }</p>
</li>
</ul>
</li>
</ul>
<h1 id="监控工具"><a href="#监控工具" class="headerlink" title="监控工具"></a>监控工具</h1><ul>
<li><p>iostat：统计CPU和设备IO信息 示例：iostat 1 10</p>
</li>
<li><p>iftop：显示带宽使用情况，EPEL源 示例：iftop -n -i eth1</p>
</li>
<li><p>pmap命令：进程对应的内存映射</p>
<p>pmap [options] pid […]</p>
<ul>
<li>-x: 显示详细格式的信息</li>
<li>示例：<code>pmap 1</code></li>
</ul>
</li>
<li><p>另外一种实现</p>
<p><code>cat /proc/PID/maps</code></p>
</li>
</ul>
<h2 id="iostat"><a href="#iostat" class="headerlink" title="iostat"></a>iostat</h2><p>iostat [ 选项 ] [ &lt;时间间隔&gt; [ &lt;次数&gt; ] ]</p>
<p>监视系统输入输出设备和CPU的使用情况</p>
<ul>
<li>-c 仅显示CPU使用情况</li>
<li>-d 显示设备（磁盘）使用状态</li>
<li>-k 显示状态以千字节每秒为单位，而不使用块每秒</li>
<li>-m 显示状态以兆字节每秒为单位</li>
<li>-p 仅显示块设备和所有被使用的其他分区的状态</li>
<li>-t 显示每个报告产生时的时间</li>
<li>-x 在输出中包括扩展的磁盘指标</li>
</ul>
<p><strong>参考实例</strong></p>
<p>每隔两秒报告一次：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@linuxcool ~]<span class="comment"># iostat -d 2</span></span><br></pre></td></tr></table></figure>
<p>每2秒报告一次，持续6次：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@linuxcool ~]<span class="comment"># iostat -d 2 6</span></span><br></pre></td></tr></table></figure>
<p>显示sda与sdc的统计数据，每2秒报告一次，持续6次：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@linuxcool ~]<span class="comment"># iostat -x sda sdc 2 6</span></span><br></pre></td></tr></table></figure>
<h2 id="glance"><a href="#glance" class="headerlink" title="glance"></a>glance</h2><ul>
<li><p>glances命令：EPEL源</p>
</li>
<li><p><code>glances [-bdehmnrsvyz1] [-B bind] [-c server] [-C conffile] [-p port] [-P password] [--password] [-t refresh] [-f file] [-o output]</code></p>
</li>
<li><p>内建命令：</p>
<ul>
<li><p>a Sort processes automatically </p>
</li>
<li><p>l Show/hide logs</p>
</li>
<li><p>c Sort processes by CPU% </p>
</li>
<li><p>b Bytes or bits for network I/O </p>
</li>
<li><p>m Sort processes by MEM% </p>
</li>
<li><p>w Delete warning logs</p>
</li>
<li><p>p Sort processes by name </p>
</li>
<li><p>x Delete warning and critical logs</p>
</li>
<li><p>i  Sort processes by I/O rate </p>
</li>
<li><p>1 Global CPU or per-CPU stats</p>
</li>
<li><p>d Show/hide disk I/O stats </p>
</li>
<li><p>h Show/hide this help screen   显示帮助</p>
</li>
<li><p>f Show/hide file system stats </p>
</li>
<li><p>t View network I/O as combination</p>
</li>
<li><p>n Show/hide network stats </p>
</li>
<li><p>u View cumulative network I/O</p>
</li>
<li><p>s Show/hide sensors stats </p>
</li>
<li><p>q Quit (Esc and Ctrl-C also work)</p>
</li>
<li><p>y Show/hide hddtemp stats</p>
</li>
</ul>
</li>
<li><p>常用选项</p>
<ul>
<li>-b: 以Byte为单位显示网卡数据速率</li>
<li>-d: 关闭磁盘I/O模块</li>
<li>-f /path/to/somefile: 设定输入文件位置</li>
<li>-o {HTML|CSV}：输出格式</li>
<li>-m: 禁用mount模块</li>
<li>-n: 禁用网络模块</li>
<li>-t #: 延迟时间间隔</li>
<li>-1：每个CPU的相关数据单独显示</li>
</ul>
</li>
<li><p>C/S模式下运行glances命令</p>
<ul>
<li>服务器模式：<br><code>glances -s -B IPADDR</code><br>IPADDR: 指明监听的本机哪个地址</li>
<li>客户端模式：<br><code>glances -c IPADDR</code><br>IPADDR：要连入的服务器端地址</li>
</ul>
</li>
</ul>
<h2 id="dstat"><a href="#dstat" class="headerlink" title="dstat"></a>dstat</h2><ul>
<li>dstat命令：系统资源统计,代替vmstat,iostat</li>
<li>dstat [-afv] [options..] [delay] [count]<ul>
<li>-c 显示cpu相关信息</li>
<li>-C #,#,…,total  分别显示  </li>
<li>-d 显示disk相关信息</li>
<li>-D total,sda,sdb,…</li>
<li>-g 显示page相关统计数据</li>
<li>-m 显示memory相关统计数据</li>
<li>-n 显示network相关统计数据</li>
<li>-p 显示process相关统计数据</li>
<li>-r 显示io请求相关的统计数据</li>
<li>-s 显示swapped相关的统计数据</li>
<li>–tcp</li>
<li>–udp</li>
<li>–unix</li>
<li>–raw</li>
<li>–socket</li>
<li>–ipc</li>
<li>–top-io: 显示最占用io的进程</li>
<li>–top-mem: 显示最占用内存的进程</li>
<li>–top-latency: 显示延迟最大的进程</li>
</ul>
</li>
</ul>
<h2 id="iotop"><a href="#iotop" class="headerlink" title="iotop"></a>iotop</h2><ul>
<li><p>iotop命令是一个用来监视磁盘I/O使用状况的top类工具</p>
<p>iotop具有与top相似的UI，其中包括PID、用户、I/O、进程等相关信息，可查看每个进程是如何使用IO</p>
</li>
<li><p>iotop输出</p>
<p><img src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/image-20200504082527152.png" alt="image-20200504082527152"></p>
<ul>
<li><p>第一行：Read和Write速率总计 </p>
</li>
<li><p>第二行：实际的Read和Write速率</p>
</li>
<li><p>第三行：参数如下：</p>
<ul>
<li>线程ID（按p切换为进程ID） </li>
<li>优先级</li>
<li>用户</li>
<li>磁盘读速率 </li>
<li>磁盘写速率</li>
<li>swap交换百分比</li>
<li>IO等待所占的百分比</li>
<li>线程/进程命令</li>
</ul>
</li>
<li><p>常用参数和快捷键</p>
<ul>
<li><p>-o, –only只显示正在产生I/O的进程或线程，除了传参，可以在运行过程中按o生效</p>
</li>
<li><p>-b, –batch非交互模式，一般用来记录日志</p>
</li>
<li><p>-n NUM, –iter=NUM设置监测的次数，默认无限。在非交互模式下很有用</p>
</li>
<li><p>-d SEC, –delay=SEC设置每次监测的间隔，默认1秒，接受非整形数据例如1.1</p>
</li>
<li><p>-p PID, –pid=PID指定监测的进程/线程</p>
</li>
<li><p>-u USER, –user=USER指定监测某个用户产生的I/O</p>
</li>
<li><p>-P, –processes仅显示进程，默认iotop显示所有线程</p>
</li>
<li><p>-a, –accumulated显示累积的I/O，而不是带宽</p>
</li>
<li><p>-k, –kilobytes使用kB单位，而不是对人友好的单位。在非交互模式下，脚本编程有用</p>
</li>
<li><p>-t, –time 加上时间戳，非交互非模式</p>
</li>
<li><p>-q, –quiet 禁止头几行，非交互模式，有三种指定方式</p>
<ul>
<li>-q 只在第一次监测时显示列名</li>
<li>-qq 永远不显示列名</li>
<li>-qqq 永远不显示I/O汇总</li>
</ul>
</li>
<li><p>交互按键</p>
<ul>
<li>left和right方向键：改变排序</li>
<li>r：反向排序</li>
<li>o：切换至选项–only</li>
<li>p：切换至–processes选项</li>
<li>a：切换至–accumulated选项</li>
<li>q：退出</li>
<li>i：改变线程的优先级</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="lsof"><a href="#lsof" class="headerlink" title="lsof"></a>lsof</h2><ul>
<li><p>lsof：list open files查看当前系统文件的工具。Linux环境下，一切皆文件，用户通过文件不仅可以访问常规数据，还可以访问网络连接和硬件如传输控制协议 (TCP) 和用户数据报协议 (UDP)套接字等，系统在后台都为该应用程序分配了一个文件描述符</p>
</li>
<li><p>命令参数</p>
<ul>
<li>-c&lt;进程名&gt;：列出指定进程所打开的文件</li>
<li>-g：列出GID号进程详情</li>
<li>-d&lt;文件号&gt;：cat列出占用该文件号的进程</li>
<li>+d&lt;目录&gt;：列出目录下被打开的文件</li>
<li>+D&lt;目录&gt;：递归列出目录下被打开的文件</li>
<li>-n&lt;目录&gt;：列出使用NFS的文件</li>
<li>-i&lt;条件&gt;：列出符合条件的进程(4、6、协议、:端口、 @ip )</li>
<li>-p&lt;进程号&gt;：列出指定进程号所打开的文件</li>
<li>-u：列出UID号进程详情</li>
<li>-P:no port names</li>
<li>-n: 不反向解析网络名字</li>
</ul>
</li>
</ul>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><ul>
<li><p>进程管理</p>
<ul>
<li>查看由登陆用户启动而非系统启动的进程<br><code>lsof /dev/pts/1</code></li>
<li>指定进程号，可以查看该进程打开的文件<br><code>lsof -p 9527 </code></li>
</ul>
</li>
<li><p>文件管理</p>
<ul>
<li>查看指定程序打开的文件<br><code>lsof -c httpd</code></li>
<li>查看指定用户打开的文件<br><code>lsof -u root | more</code></li>
<li>查看指定目录下被打开的文件<ul>
<li><code>lsof +D /var/log/ </code></li>
<li><code>lsof +d /var/log/</code></li>
<li>参数+D为递归列出目录下被打开的文件，参数+d为列出目录下被打开的文件</li>
</ul>
</li>
</ul>
</li>
<li><p>查看所有网络连接</p>
<ul>
<li><code>lsof -i –n </code></li>
<li><code>lsof -i@127.0.0.1</code></li>
<li>通过参数-i查看网络连接的情况，包括连接的ip、端口等以及一些服务的连接情况，例如：sshd等。也可以通过指定ip查看该ip的网络连接情况</li>
</ul>
</li>
<li><p>查看端口连接情况</p>
<ul>
<li><code>lsof -i :80 -n</code></li>
<li>通过参数-i:端口可以查看端口的占用情况，-i参数还有查看协议，ip的连接情况等</li>
</ul>
</li>
<li><p>查看指定进程打开的网络连接</p>
<ul>
<li><code>lsof -i –n -a -p 9527</code></li>
<li>参数-i、-a、-p等，-i查看网络连接情况，-p指定进程</li>
</ul>
</li>
<li><p>查看指定状态的网络连接</p>
<ul>
<li><code>lsof -n -P -i TCP -s TCP:ESTABLISHED</code></li>
<li>-n:no host names, -P:no port names,-i TCP指定协议，-s指定协议状态通过多个参数可以清晰的查看网络连接情况、协议连接情况等</li>
</ul>
</li>
<li><p>恢复删除文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lsof |grep /var/<span class="built_in">log</span>/messages</span><br><span class="line">rm -f /var/<span class="built_in">log</span>/messages</span><br><span class="line">lsof |grep /var/<span class="built_in">log</span>/messages</span><br><span class="line">cat /proc/653/fd/6</span><br><span class="line">cat /proc/653/fd/6 &gt; /var/<span class="built_in">log</span>/messages</span><br></pre></td></tr></table></figure>
<h1 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h1></li>
</ul>
<p>Linux任务计划、周期性任务执行</p>
<ul>
<li>未来的某时间点执行一次任务<ul>
<li>at 指定时间点，执行一次性任务</li>
<li>batch 系统自行选择空闲时间去执行此处指定的任务</li>
</ul>
</li>
<li>周期性运行某任务<ul>
<li>cron</li>
</ul>
</li>
</ul>
<h2 id="at"><a href="#at" class="headerlink" title="at"></a>at</h2><ul>
<li>包：at</li>
<li>at 命令：at [option] TIME</li>
<li>常用选项：<ul>
<li>-V 显示版本信息</li>
<li>-t time 时间格式 [[CC]YY]MMDDhhmm[.ss] </li>
<li>-l 列出指定队列中等待运行的作业；相当于atq</li>
<li>-d 删除指定的作业；相当于atrm</li>
<li>-c 查看具体作业任务</li>
<li>-f /path/file 指定的文件中读取任务</li>
<li>-m 当任务被完成之后，将给用户发送邮件，即使没有标准输出</li>
</ul>
</li>
<li>注意：作业执行命令的结果中的标准输出和错误以邮件通知给相关用户</li>
</ul>
<h3 id="时间格式"><a href="#时间格式" class="headerlink" title="时间格式"></a>时间格式</h3><p>TIME：定义出什么时候进行 at 这项任务的时间</p>
<ul>
<li>HH:MM [YYYY-mm-dd]</li>
<li>noon, midnight, teatime（4pm）</li>
<li>tomorrow</li>
<li>now+#{minutes,hours,days, OR weeks}</li>
</ul>
<hr>
<ul>
<li><p>HH:MM 02:00</p>
<p>在今日的 HH:MM 进行，若该时刻已过，则明天此时执行任务</p>
</li>
<li><p>HH:MM YYYY-MM-DD 02:00 2016-09-20</p>
<p>规定在某年某月的某一天的特殊时刻进行该项任务</p>
</li>
<li><p>HH:MM[am|pm] [Month] [Date]</p>
<ul>
<li>04pm March 17</li>
<li>17:20 tomorrow</li>
</ul>
</li>
<li><p>HH:MM[am|pm] + number [minutes|hours|days|weeks]</p>
<p>在某个时间点再加几个时间后才进行该项任务</p>
<ul>
<li>now + 5 min </li>
<li>02pm + 3 days</li>
</ul>
</li>
</ul>
<h3 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h3><ul>
<li><p>执行方式：</p>
<p>1）交互式<br>2）输入重定向<br>3）at -f 文件</p>
</li>
<li><p>依赖与atd服务,需要启动才能实现at任务</p>
</li>
<li><p>at队列存放在/var/spool/at目录中</p>
</li>
<li><p>/etc/at.{allow,deny}控制用户是否能执行at任务</p>
<ul>
<li>白名单：/etc/at.allow 默认不存在，只有该文件中的用户才能执行at命令</li>
<li>黑名单：/etc/at.deny 默认存在，拒绝该文件中用户执行at命令，而没有在at.deny 文件中的使用者则可执行</li>
<li>如果两个文件都不存在，只有 root 可以执行 at 命令</li>
</ul>
</li>
</ul>
<h2 id="cron"><a href="#cron" class="headerlink" title="cron"></a>cron</h2><ul>
<li><p>周期性任务计划：cron</p>
</li>
<li><p>相关的程序包：</p>
<ul>
<li>cronie：主程序包，提供crond守护进程及相关辅助工具</li>
<li>crontabs：包含CentOS提供系统维护任务</li>
<li>cronie-anacron：cronie的补充程序，用于监控cronie任务执行状况，如cronie中的任务在过去该运行的时间点未能正常运行，则anacron会随后启动一次此任务</li>
</ul>
</li>
<li><p>计划周期性执行的任务提交给crond，到指定时间会自动运行</p>
<ul>
<li>系统cron任务：系统维护作业<ul>
<li>/etc/crontab</li>
</ul>
</li>
<li>用户cron任务：<ul>
<li>crontab命令</li>
</ul>
</li>
</ul>
</li>
<li><p>日志：/var/log/cron</p>
</li>
<li><p>系统的计划任务:</p>
<ul>
<li>/etc/crontab 配置文件</li>
<li>/etc/cron.d/ 配置文件</li>
<li>/etc/cron.hourly/ 脚本</li>
<li>/etc/cron.daily/ 脚本</li>
<li>/etc/cron.weekly/ 脚本</li>
<li>/etc/cron.monthly/ 脚本</li>
</ul>
</li>
</ul>
<h3 id="时间格式-1"><a href="#时间格式-1" class="headerlink" title="时间格式"></a>时间格式</h3><ul>
<li><p>系统cron任务:/etc/crontab</p>
</li>
<li><p>注释行以# 开头</p>
</li>
<li><p>详情参见  man 5 crontab</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example of job definition:</span></span><br><span class="line"><span class="comment"># .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="comment"># | .------------- hour (0 - 23)</span></span><br><span class="line"><span class="comment"># | | .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="comment"># | | | .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="comment"># | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="comment"># | | | | |</span></span><br><span class="line"><span class="comment"># * * * * * user-name command to be executed</span></span><br></pre></td></tr></table></figure></li>
<li><p>时间表示法：</p>
<ul>
<li><p>(1) 特定值<br>给定时间点有效取值范围内的值</p>
</li>
<li><p>(2) *<br>给定时间点上有效取值范围内的所有值<br>表示“每…”</p>
</li>
<li><p>(3) 离散取值</p>
<p>#,#,#</p>
</li>
<li><p>(4) 连续取值</p>
<p>#-#</p>
</li>
<li><p>(5) 在指定时间范围上，定义步长<br>/#: #即为步长</p>
</li>
<li><p>其他示例：</p>
<ul>
<li>@yearly 0 0 1 1 *</li>
<li>@annually 0 0 1 1 *</li>
<li>@monthly 0 0 1 * *</li>
<li>@weekly 0 0 * * 0</li>
<li>@daily 0 0 * * *</li>
<li>@hourly 0 * * * *</li>
<li>@reboot Run once after reboot</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><ul>
<li>crontab命令定义<br>每个用户都有专用的cron任务文件：/var/spool/cron/USERNAME</li>
<li>crontab命令：<br>crontab [-u user] [-l | -r | -e] [-i] <ul>
<li>-l 列出所有任务</li>
<li>-e 编辑任务</li>
<li>-r 移除所有任务</li>
<li>-i 同-r一起使用，以交互式模式移除指定任务</li>
<li>-u user 仅root可运行，指定用户管理cron任务</li>
</ul>
</li>
<li>控制用户执行计划任务：<ul>
<li>/etc/cron.{allow,deny}</li>
</ul>
</li>
</ul>
<h2 id="at和cron差异"><a href="#at和cron差异" class="headerlink" title="at和cron差异"></a>at和cron差异</h2><ul>
<li>一次性作业使用 at</li>
<li>重复性作业使用crontab<ul>
<li>Create at time crontab -e </li>
<li>List at -l crontab -l </li>
<li>Details at -c jobnum crontab -l </li>
<li>Remove at -d jobnum crontab -r </li>
<li>Edit N/A crontab -e</li>
</ul>
</li>
<li>没有被重定向的输出会被邮寄给用户</li>
<li>root能够修改其它用户的作业</li>
</ul>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><ul>
<li>注意：运行结果的标准输出和错误以邮件通知给相关用户<br>(1) COMMAND &gt; /dev/null<br>(2) COMMAND &amp;&gt; /dev/null</li>
<li>对于cron任务来讲，%有特殊用途；如果在命令中要使用%，则需要转义，将%放置于单引号中，则可不用转义</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:kinmfer@foxmail.com">Kinmfer</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kinmfer.github.io/2020/05/03/Linux%E5%9F%BA%E7%A1%80-09-%E8%BF%9B%E7%A8%8B+%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/">https://kinmfer.github.io/2020/05/03/Linux基础-09-进程+计划任务/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Kinmfer.github.io" target="_blank">Kinmfer's Blogs</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux%E5%9F%BA%E7%A1%80/">Linux基础</a><a class="post-meta__tags" href="/tags/%E7%B3%BB%E7%BB%9F/">系统</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/05/04/Linux%E5%9F%BA%E7%A1%80-10-%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/"><img class="prev-cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux基础-10-包管理工具</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/03/Linux%E5%9F%BA%E7%A1%80-08-%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2/"><img class="next-cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux基础-08-文本三剑客</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/05/02/Linux基础-03-IO重定向+管道/" title="Linux基础-03-IO重定向+管道"><img class="cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-02</div><div class="title">Linux基础-03-IO重定向+管道</div></div></a></div><div><a href="/2020/05/03/Linux基础-06-vim/" title="Linux基础-06-vim"><img class="cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-03</div><div class="title">Linux基础-06-vim</div></div></a></div><div><a href="/2020/05/03/Linux基础-07-文本处理+正则表达式/" title="Linux基础-07-文本处理+正则表达式"><img class="cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-03</div><div class="title">Linux基础-07-文本处理+正则表达式</div></div></a></div><div><a href="/2020/05/04/Linux基础-13-CentOS7启动流程+Systemd管理/" title="Linux基础-13-CentOS7启动流程+Systemd管理"><img class="cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-04</div><div class="title">Linux基础-13-CentOS7启动流程+Systemd管理</div></div></a></div><div><a href="/2020/05/03/Linux基础-05-文件管理/" title="Linux基础-05-文件管理"><img class="cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-03</div><div class="title">Linux基础-05-文件管理</div></div></a></div><div><a href="/2020/05/03/Linux基础-04-用户组+权限管理/" title="Linux基础-04-用户组+权限管理"><img class="cover" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-03</div><div class="title">Linux基础-04-用户组+权限管理</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Livere</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="lv-container" data-id="city" data-uid="MTAyMC81MTkzMi8yODQxMw=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://gitee.com/Kinmfer/BlogImages/raw/master/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Kinmfer</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">105</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">63</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Kinmfer"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Kinmfer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:kinmfer@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客！本博客用于记录一些学习过程中的文章，包括原创，也包括转录其他大神的博客。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">进程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%EF%BC%8C%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%8D%8F%E7%A8%8B"><span class="toc-number">1.1.</span> <span class="toc-text">进程，线程和协程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-number">1.2.</span> <span class="toc-text">相关概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%92%8C%E5%86%85%E6%A0%B8%E7%A9%BA%E9%97%B4"><span class="toc-number">1.3.</span> <span class="toc-text">用户和内核空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%8A%B6%E6%80%81%E5%8F%8A%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.4.</span> <span class="toc-text">进程的基本状态及转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LRU%E7%AE%97%E6%B3%95"><span class="toc-number">1.5.</span> <span class="toc-text">LRU算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPC%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-number">1.6.</span> <span class="toc-text">IPC进程间通信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">1.7.</span> <span class="toc-text">进程优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81"><span class="toc-number">1.8.</span> <span class="toc-text">进程运行状态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.9.</span> <span class="toc-text">进程的分类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-number">2.</span> <span class="toc-text">管理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B-1"><span class="toc-number">2.1.</span> <span class="toc-text">进程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pstree"><span class="toc-number">2.1.1.</span> <span class="toc-text">pstree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ps"><span class="toc-number">2.1.2.</span> <span class="toc-text">ps</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ps%E5%B8%B8%E8%A7%81%E9%80%89%E9%A1%B9"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">ps常见选项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ps%E8%BE%93%E5%87%BA%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">ps输出属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ps%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.1.2.3.</span> <span class="toc-text">ps示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pgrep"><span class="toc-number">2.1.3.</span> <span class="toc-text">pgrep</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pidof"><span class="toc-number">2.1.4.</span> <span class="toc-text">pidof</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#top"><span class="toc-number">2.1.5.</span> <span class="toc-text">top</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#htop"><span class="toc-number">2.1.6.</span> <span class="toc-text">htop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kill"><span class="toc-number">2.1.7.</span> <span class="toc-text">kill</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98"><span class="toc-number">2.2.</span> <span class="toc-text">内存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#free"><span class="toc-number">2.2.1.</span> <span class="toc-text">free</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#cache%E5%92%8Cbuffer%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">cache和buffer的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vmstat"><span class="toc-number">2.2.2.</span> <span class="toc-text">vmstat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pmap"><span class="toc-number">2.2.3.</span> <span class="toc-text">pmap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E4%B8%9A%E7%AE%A1%E7%90%86"><span class="toc-number">2.3.</span> <span class="toc-text">作业管理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7"><span class="toc-number">3.</span> <span class="toc-text">监控工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#iostat"><span class="toc-number">3.1.</span> <span class="toc-text">iostat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#glance"><span class="toc-number">3.2.</span> <span class="toc-text">glance</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dstat"><span class="toc-number">3.3.</span> <span class="toc-text">dstat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iotop"><span class="toc-number">3.4.</span> <span class="toc-text">iotop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lsof"><span class="toc-number">3.5.</span> <span class="toc-text">lsof</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.5.1.</span> <span class="toc-text">示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="toc-number">4.</span> <span class="toc-text">计划任务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#at"><span class="toc-number">4.1.</span> <span class="toc-text">at</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.1.1.</span> <span class="toc-text">时间格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1"><span class="toc-number">4.1.2.</span> <span class="toc-text">任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cron"><span class="toc-number">4.2.</span> <span class="toc-text">cron</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">时间格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4"><span class="toc-number">4.2.2.</span> <span class="toc-text">命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#at%E5%92%8Ccron%E5%B7%AE%E5%BC%82"><span class="toc-number">4.3.</span> <span class="toc-text">at和cron差异</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-number">4.4.</span> <span class="toc-text">注意</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/05/03/%E6%8A%80%E5%B7%A7-02-%E4%B8%8B%E8%BD%BDgcr%E9%95%9C%E5%83%8F/" title="技巧-02-下载gcr镜像"><img src="https://gitee.com/kinmfer/BlogImages/raw/master/img/gcr.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="技巧-02-下载gcr镜像"/></a><div class="content"><a class="title" href="/2021/05/03/%E6%8A%80%E5%B7%A7-02-%E4%B8%8B%E8%BD%BDgcr%E9%95%9C%E5%83%8F/" title="技巧-02-下载gcr镜像">技巧-02-下载gcr镜像</a><time datetime="2021-05-03T06:42:06.000Z" title="发表于 2021-05-03 14:42:06">2021-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-Prometheus-PromeQL/" title="综合架构-Prometheus-PromQL"><img src="https://gitee.com/kinmfer/BlogImages/raw/master/img/prometheus.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="综合架构-Prometheus-PromQL"/></a><div class="content"><a class="title" href="/2021/04/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-Prometheus-PromeQL/" title="综合架构-Prometheus-PromQL">综合架构-Prometheus-PromQL</a><time datetime="2021-04-29T08:03:41.000Z" title="发表于 2021-04-29 16:03:41">2021-04-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/22/%E4%BA%91%E8%AE%A1%E7%AE%97-Kubernetes-%E5%8D%87%E7%BA%A7/" title="云计算-Kubernetes-升级"><img src="https://gitee.com/kinmfer/BlogImages/raw/master/img/k8s-logo.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算-Kubernetes-升级"/></a><div class="content"><a class="title" href="/2021/04/22/%E4%BA%91%E8%AE%A1%E7%AE%97-Kubernetes-%E5%8D%87%E7%BA%A7/" title="云计算-Kubernetes-升级">云计算-Kubernetes-升级</a><time datetime="2021-04-22T07:02:41.000Z" title="发表于 2021-04-22 15:02:41">2021-04-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/04/GOLANG-16-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="GOLANG-16-网络编程"><img src="https://gitee.com/kinmfer/BlogImages/raw/master/img/GO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GOLANG-16-网络编程"/></a><div class="content"><a class="title" href="/2021/02/04/GOLANG-16-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="GOLANG-16-网络编程">GOLANG-16-网络编程</a><time datetime="2021-02-04T12:10:02.000Z" title="发表于 2021-02-04 20:10:02">2021-02-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/03/GOLANG-15-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" title="GOLANG-15-单元测试"><img src="https://gitee.com/kinmfer/BlogImages/raw/master/img/GO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GOLANG-15-单元测试"/></a><div class="content"><a class="title" href="/2021/02/03/GOLANG-15-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" title="GOLANG-15-单元测试">GOLANG-15-单元测试</a><time datetime="2021-02-03T12:28:06.000Z" title="发表于 2021-02-03 20:28:06">2021-02-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://gitee.com/Kinmfer/BlogImages/raw/master/img/1soSr8.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Kinmfer</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://kinmfer.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'vSKb5nQqvUv44yjbvGjUmk3E-gzGzoHsz',
      appKey: '4TRbJGECRE8pcN777qgBXsKO',
      placeholder: '记得留下你的昵称和邮箱,可以快速收到回复哦~',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: {"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_����":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","tv_͵Ц":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_�ټ�":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_��Į":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_��ŭ":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_�ɰ�":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_��Ѫ":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_��":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_Ż��":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_��Ц":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_���":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_ί��":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_΢Ц":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_˼��":"90cf159733e558137ed20aa04d09964436f618a1.png"},
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Valine' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script src="//code.tidio.co/mzqu2o1lbhle9bvhab8bexgtiyxgkheb.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>